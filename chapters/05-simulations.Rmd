# [Tentative Title] The Effect of Population Dynamics, Sample Size, and Marker Choice on the Index of Association

## Abstract

TBD...

## Introduction

<!-- ZHIAN

 Thinking about different topics to address here. 

 -->

Population genetics largely is based off of the neutral assumption that
populations exist in Hardy-Weinberg Equilibrium (HWE) in that they are
infinitely large, with no migration, no mutation, and randomly mating, where
alleles across loci are I.I.D. This neutral model works well to describe
populations that reproduce exclusively via sexual reproduction, but it becomes
less useful when considering populations that undergo some form of clonal
reproduction since the alleles for different samples are no longer I.I.D. This
confounds the ability to accurately assess population demographics including
effective population size [@orive1993effective]. Many clonal organisms are also
pathogenic, and knowing basic population dynamics of these pathogens is 
important for management strategies [@smith1993how; @milgroom1996recombination;
@milgroom1997contributions; @de2006molecular; @nieuwenhuis2016frequency]. 

The theory of population genetics for clonal organisms has been deeply
investigated over time [@orive1993effective; @halkett2005tackling;
@arnaud2007standardizing]. In particular, there has been a re-occurring question
of how much sex can be detected in a population of organisms with (partially)
clonal reproduction [@smith1993how; @balloux2003population; @de2004clonal;
@ali2016cloncase; @nieuwenhuis2016frequency]. For populations with well-defined
sexual and clonal phases occurring at separate times, methods like CloNcaSe are
effective for estimating the rate of sexual reproduction and effective
population size [@ali2016cloncase]. However, when sexual reproduction is not a
cyclical phenomena, this estimator is useless. Currently, a method commonly used
to assess clonal reproduction is the index of assocation ($I_A$), and its 
standardized version, $\bar{r}_d$, which measure multilocus linkage 
disequilibrium [@brown1980multilocus; @smith1993how; @haubold1998detecting; @Agapow_2001; 
@de2004clonal; @kamvar2014poppr]. The value of $I_A$ is measured as a ratio of
the observed and expected variance of differences between samples across loci 
(equation \@ref(eq:ia)) [@smith1993how; @Agapow_2001]:

\begin{equation}
I_A = \frac{V_O}{V_E} - 1 (\#eq:ia)
\end{equation}


The values of $\bar{r}_d$ range from 0 for completely unlinked loci to 1 for complete linkage across all loci. @de2004clonal investigated the effect of increasing levels of sexual reproduction on $\bar{r}_d$ (noted in their publication as $\bar{r}_D$), finding that it increased in variance with decreasing rates of sexual reproduction. 

 - Population Genetics of partially clonal organisms
 	- This has been studied in the past [@smith1993how; @balloux2003population;
 	  @de2004clonal; @orive1993effective]
 	- The index of association [@brown1980multilocus; @smith1993how;
 	  @Agapow_2001]
 	- In @de2004clonal, it was shown that $\bar{r}_d$ has a high variance in
 	  clonal populations and @smith1993how showed that it's affected by
 	  population structure.
 - Methods for assessing level of clonal reproduction (CloNcaSe)
   [@ali2016cloncase]
 	- This only works for populations with discrete generations with an
 	  observable sexual stage.
 - Limitations of previous studies
 	- No HTS markers
 	- Significance tests are routinely performed via permutation analysis, but
 	  could not be performed due to software limitations [@burt1996molecular;
 	  @de2004clonal]
 - Questions
 	1. With the advent of GBS, does marker choice affect inference of clonality?
 	2. Does sample size significantly affect our ability to detect clonal
 	   reproduction?
 	3. Can a combination of genotypic diversity estimators and allelic diversity
 	   estimator provide support for significantly negative values of
 	   $\bar{r}_d$?
 - Objectives
 	1. Analyze mixtures of clonal populations to assess effect of sampling
 	   multiple clonal populations.
 	1. Assess the effect of a single hypervariable locus on $\bar{r}_d$
 	2. Re-analyze rates of sexual reproduction to confirm previous study
 	   with and without clone-correction [@de2004clonal].
 	3. Power analysis of $\bar{r}_d$.
 	4. Investigate dynamics of populations with significantly negative (p = 1)
 	   values of $\bar{r}_d$.
	5. Assess $E_5$, *H*, $eMLG_{10}$, and unbiased Simpson's diversity.



## Methods

Initial sets of simulations were created for different levels of sexual
reproduction for each marker type. All simulations were performed with the
python package simuPOP version 1.1.7 in python version 3.4. For each scenario,
100 simulations with 10 replicates were created with a census size of 10,000
diploid individuals with equal mating type proportions evolved over 10,000
generations. From each replicate, 10, 25, 50, and 100 individuals were sampled
without replacement for downstream analysis in R version 3.2 with the package
*poppr* version 2.2.1 on full and clone-corrected data sets. All downstream
analyses were run on the OSU CGRB Core Computing Facility (supplementary
information).

### Simulating Microsatellite Loci

Each population was simulated with 20 co-dominant, unlinked loci containing 6 to
10 alleles per locus with frequencies drawn from a uniform distribution and
subsequently normalized. Before mating, mutations occurred at each locus at a
rate of 1e-5 mutations/generation in a stepwise manner using the
`StepwiseMutator()` operator.

### GBS Simulations

Simulations of 10,000 binary loci at spread evenly over 10 chromosomal fragments
were simulated with a mutation rate of 1e-5 mutations per generation for forward
and backward mutations using the `SNPMutator()` operator and and a recombination
rate of 1e-5 between adjacent loci using the `Recombinator()` operator.

### Sexual Reproduction

Simulations of sexual reproduction were analyzed at 10 rates of sexual
reproduction on a log scale (0.0, 1e-4, 5e-4, 1e-3, 5e-3, 1e-2, 5e-2, 0.1, 0.5,
1.0) reflecting the fraction of individuals in generation *t+1* produced via
sexual reproduction. One to three offspring could be produced at each mating
event. For sexual events, two parents were chosen randomly from the population
with the `RandomSelection()` operator and offspring genotypes were created via
the `MendelianGenoTransmitter()` operator. The clonal fraction was created by
randomly sampling individuals from the population and duplicating their
genotypes with the `CloneGenoTransmitter()` operator. If one mating type was
lost before 10,000 generations, the simulation would continue to completion with
only clonal reproduction.

### Analysis of Microsatellite Data

The standardized index of association ($\bar{r}_d$) was calculated for full and
clone-corrected data using the *poppr* function `ia()`. Tests for significance
were performed by randomly permuting the alleles at each locus independently and
then assessing $\bar{r}_d$. This was done 999 times for each replicate
population. Re-sampling was not performed with clone-corrected data. The p-values
reflect the proportion of observations greater than the observed statistic.
Estimates of genotypic diversity were assessed with the *poppr* function
`diversity_boot()` with 999 bootstrap replicates, recording the estimate and
variance.

### Analysis of SNP Data

Because GBS data are associated with high error rates, we additionally wanted to
assess the effect of error and missing data on analysis. To do this, we used
scripts written for @kamvar2015novel to randomly insert missing data (via the
`pop_NA()` function) and genotyping errors (via the `pop_mutator()`)
[@kamvar2015poppr2supp] at rates of 5% and 10% each. We then used the *poppr*
function `mlg.filter()` to with the farthest neighbor algorithm to collapse
multilocus genotypes with 5% and 10% similarity and compared the results with
the known genotypes. Genotypic diversity was assessed with the *poppr* function
`diversity_boot()` with 999 bootstrap replicates on the filtered data sets,
recording the variance.

The overall value of $\bar{r}_d$ was calculated for each simulation with the
*poppr* function `bitwise.ia()`. To assess within-chromosome dynamics, values of
$\bar{r}_d$ were calculated along chromosomes using the *poppr* function
`win.ia()` along windows of 50 and 100 SNPs. Cross-chromosome dynamics of
$\bar{r}_d$ were assessed by utilizing random samples of 50, 100, and 1000 SNPs
replicated 999 times for each population sample. 

### Power Analysis

The Receiver Operating Characteristic (ROC) curve is a method of assessing the
explanatory power of a method by assessing the true positive fraction of tests
to a false positive fraction [@metz1978basic]. Briefly, if a method has perfect
explanatory power, the area under the ROC curve will be equal to 1. If a method
has no explanatory power, the area under the ROC curve will be equal to 0.5.
ROC analysis was carried as described in @metz1978basic as a comparison of the
false positive fraction to the true positive fraction as you increase the level
of rejection, ($\alpha$). The null hypothesis for the ROC analysis was defined
where the rate of sexual reproduction was 100%. All other rates were considered
to be separate alternative hypotheses. The curves were calculated by analyzing
the data sets over increasing values of $\alpha$ from 0 to 1 in increments of
0.01. The area under the ROC curves was calculated using the `trapz()` function
in the R package *pracma* version 1.9.5 [@borchers2016pracma]. ANOVA was run
with the following models:

|                                               |
|:---------------------------------------------:|
| False Positive Rate ~ Sex Rate + Sample Size  |
| Area Under ROC Curve ~ Sex Rate + Sample Size |

